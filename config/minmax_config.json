{
  "policy_model": {
    "model_name": "mistralai/Mistral-7B-Instruct-v0.3",
    "load_in_8bit": false,
    "use_lora": true,
    "lora_r": 16,
    "lora_alpha": 32,
    "lora_dropout": 0.1,
    "temperature": 1.0,
    "top_p": 0.9,
    "do_sample": true,
    "max_length": 1096,
    "max_new_tokens": 200
  },
  "monitor_model": {
    "model_name": "meta-llama/Meta-Llama-3.1-8B-Instruct",
    "load_in_8bit": false,
    "use_lora": true,
    "lora_r": 16,
    "lora_alpha": 32,
    "lora_dropout": 0.1,
    "temperature": 1.0,
    "top_p": 0.95,
    "do_sample": true,
    "repetition_penalty": 1.1,
    "torch_dtype": "bfloat16",
    "max_length": 1096,
    "max_new_tokens": 200
  },
  "reward_model": {
    "model_name": "Skywork/Skywork-Reward-V2-Llama-3.1-8B",
    "torch_dtype": "bfloat16",
    "max_length": 2048
  },
  "judge_model": {
    "model_name": "mistralai/Mistral-7B-Instruct-v0.3",
    "temperature": 1.0,
    "do_sample": false,
    "load_in_8bit": true,
    "torch_dtype": "bfloat16",
    "max_length": 2048,
    "max_new_tokens": 100
  },
  "training": {
    "policy_learning_rate": 1e-6,
    "monitor_learning_rate": 4e-6,
    "monitor_updates_per_policy": 5,
    "constraint_penalty_lambda": 10.0,
    "constraint_threshold": -3.6,
    "dual_ascent_step_size": 0.25,
    "monitor_verdict_weight": 0.6,
    "monitor_reward_weight": 0.4,
    "use_monitor_rewards": true,
    "reward_weight": 0.5,
    "judge_weight": 0.5,
    "batch_size": 3,
    "mini_batch_size": 3,
    "ppo_epochs": 1,
    "num_epochs": 8,
    "init_kl_coef": 0.02,
    "target_kl": 6.0,
    "kl_penalty": "full",
    "cliprange": 0.2,
    "cliprange_value": 0.2,
    "vf_coef": 0.1,
    "max_grad_norm": 0.5,
    "eval_frequency": 2,
    "save_frequency": 2,
    "num_train_samples": 200
  },
  "evaluation": {
    "num_eval_samples": 100,
    "log_frequency": 1,
    "progress_frequency": 5
  },
  "data": {
    "data_dir": "dataset/qa_simple/data",
    "safety_margin": 80,
    "story_truncation_strategy": "intelligent",
    "answer_parsing_strategy": "ab_pattern", 
    "response_extraction_strategy": "auto",
    "answer_choices_format": "AB",
    "num_choices": 2
  },
  "logging": {
    "backends": ["tensorboard"],
    "tensorboard": {
      "log_dir": "./tensorboard_logs"
    },
    "wandb_config": {
      "project": "minmax_rlhf",
      "entity": null,
      "tags": ["minmax", "qa_simple"],
      "log_frequency": 5
    },
    "enable_console_fallback": true
  },
  "save_dir": "./outputs/minmax",
  "seed": 42
}
